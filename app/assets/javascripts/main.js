(function ($) {  $.extend(true, window, {    constants: {      ANIMATION_DURATION: 200    },    utilities: {      toggleCollapsed: function (sender, collapsedElement) {        $(sender).children('.expand_button, .collapse_button').toggleclass('expand_button').toggleclass('collapse_button');        $('#' + collapsedelement).animate({ height: 'toggle' }, animation_duration);      },      search: function(sender, path, query) {        query = $.trim(query);        $.ajax({          url: path + '?search=' + encodeURIComponent(query),          context: sender        });      },      addAlert: function(message, type) {        var clientAlerts = $('#client_alerts');        clientAlerts.append('<div class="alert ' + type + '">' + CLOSE_BUTTON + message + '</div>');        clientAlerts.children('.alert').filter(':last').children('.close').on('click.alert', function() { $(this).parent().remove(); });      }    }  });    var CLOSE_BUTTON = '<button class="close">&times;</button>';    $(function() {    //Enable alert closing    $('.alert').each(function() {      var alert = $(this);      alert.prepend(CLOSE_BUTTON);      alert.children('.close').on('click.alert', function() { alert.remove(); });    });        //Attach submit click handlers    //$(document).on('click.submit', 'a.submit', function() { $(this).closest('form').submit(); return false; });    //$(document).on('click.submit', 'input.submit', function() { $(this).closest('form').submit(); });        $('.timeago').timeago();  });    $(document).ajaxComplete(function(event, request) {    var error = request.getResponseHeader('Alert-Error-Message');    if (error) utilities.addAlert(error, 'error');        var warning = request.getResponseHeader('Alert-Warning-Message');    if (warning) utilities.addAlert(warning, 'warning');        var notice = request.getResponseHeader('Alert-Notice-Message');    if (notice) utilities.addAlert(notice, 'notice');        $('.timeago').timeago();  });})(jQuery);